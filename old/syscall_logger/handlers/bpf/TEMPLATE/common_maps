// --- common_maps (BCC style) ---

// ON/OFF flag to control event production (1 entry)
BPF_ARRAY(cfg_enabled, u32, 1);

// Per-CPU counter of successfully emitted events (1 entry)
BPF_PERCPU_ARRAY(ev_count, u64, 1);

// Check if the producer is enabled (cfg_enabled[0] == 1)
static __always_inline int producer_enabled(void) {
    u32 k = 0;
    u32 *en = cfg_enabled.lookup(&k);
    return en && *en;   // 1 => enabled, 0 => disabled
}

// Increment the per-CPU event counter (safe operation)
static __always_inline void inc_ev_count(void) {
    u32 k = 0;
    u64 *c = ev_count.lookup(&k);
    if (c) (*c)++;      // safe ++ because it is per-CPU
}

//TODO add a losted events counter for tuning